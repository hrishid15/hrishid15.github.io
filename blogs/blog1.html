<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chasing digital downforce</title>
    <link rel="icon" type="image/png" href="../assets/images/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Add KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <style>
       * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Text', serif;
            background-color: #ffffff;
            color: #2a2a2a;
            line-height: 1.8;
            padding: 60px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 40px;
        }

        .header-flex {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-bottom: 20px;
        }

        .header-flex .back-link {
            position: absolute;
            left: 0;
            font-size: 1rem;
            color: #555;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.3s ease;
        }

        .header-flex .back-link:hover {
            border-bottom-color: #555;
        }

        h1 {
            font-size: 2.4rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-align: center;
        }

        .post-date {
            text-align: center;
            font-size: 0.95rem;
            color: #777;
            font-style: italic;
            margin-bottom: 40px;
        }

        .aero-canvas-container {
            position: relative;
            width: 100%;
            height: 200px;
            margin: 15px 0 30px 0;
            background: transparent;
            border-radius: 0;
            overflow: hidden;
        }

        #aeroCanvas {
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }

        .canvas-label {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.85rem;
            color: #999;
            font-style: italic;
        }

       .content {
            font-size: 1.15rem;
            line-height: 1.9;
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin: 25px 0 25px 0;
            color: #2a2a2a;
        }

        h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 20px 0 20px 0;
            color: #2a2a2a;
        }

        p {
            margin-bottom: 20px;
        }

        .equation {
            background: #fff;
            border-left: 3px solid #8b7355;
            margin: 30px 0;
            font-size: 1.4rem;
            overflow-x: auto;
            text-align: center;
        }

        .visualization-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .viz-card {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .viz-card h4 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .viz-placeholder {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #f5f3ed 0%, #e8e6dd 100%);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-style: italic;
            margin-bottom: 15px;
        }

        .viz-description {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.6;
        }

        .katex {
            font-size: 1.6em;
        }

        .content .katex {
            font-size: 0.95em;
        }

        code {
            background: #f0ece3;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        .callout {
            background: #fff9f0;
            border-left: 4px solid #8b7355;
            padding: 20px;
            margin: 30px 0;
        }

        .callout-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .callout a {
            color: inherit;
            text-decoration: none;
            transition: text-decoration 0.2s ease;
        }

        .callout a:hover,
        .callout a:focus {
            text-decoration: underline;
        }

        @media (max-width: 600px) {
            body {
                padding: 40px 20px;
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            .aero-canvas-container {
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-flex">
                <a href="../blog.html" class="back-link">‚Üê back</a>
                <h1>Chasing Digital Downforce</h1>
            </div>
            <p class="post-date">October 17, 2025</p>
        </header>

        <div class="content">
            <!-- Interactive Demo -->
            <div class="interactive-demo">
                <div class="aero-canvas-container">
                    <canvas id="aeroCanvas"></canvas>
                    <span class="canvas-label">hover to create airflow</span>
                </div>
            </div>

            <!-- Introduction -->

            <p>
                Over the past couple of days, I've been working on a computational fluid dynamics (CFD) simulation to visualize and calculate 
                aerodynamic forces for different vehicle shapes. I will do my best to explain the physics, the math, and see how subtle changes 
                in geometry can create massive differences in performance. I will state that I am in no way an expert in fluid dynamics or aerodynamic design
                and this is project is purely out of personal curiousity, so if you happen to find anything I can modify or fix, feel free to reach out!

                
            </p>

            <!-- Drag Section -->
            <h2>Understanding Drag</h2>
            
            <p>
                Let's start with drag, because I feel like its one of the easier concepts to explain.
                Drag is the aerodynamic force that resists a vehicle's motion through air. It's why you need to keep pressing 
                the accelerator to maintain high speeds on a highway (or on a track of you're racing). 
                Whenever you drive fast, you're constantly fighting against drag. The faster you go, the more 
                drag you experience, and it grows proportionally to the square of velocity.
            </p>

            <p>
                The drag force can be calculated using the drag equation:
            </p>

            <div class="equation">
                $$F_{\text{drag}} = \frac{1}{2} \rho v^2 C_d A$$
            </div>

            <p>
                where:
            </p>
            <ul style="margin-left: 40px; margin-bottom: 20px;">
                <li>$\rho$ is air density</li>
                <li>$v$ is velocity relative to the air</li>
                <li>$C_d$ is the drag coefficient</li>
                <li>$A$ is the total 2D area opposing airflow</li>
            </ul>

            <p>
                The drag coefficient is highly dependent on the shape of the vehicle. A typical sedan has a $C_d$ around 0.30, 
                while a Formula 1 car might have a $C_d$ around 0.70. However, F1 cars generate massive downforce to compensate, 
                allowing for much higher cornering speeds, but we'll get into that in a little bit.
            </p>

            <div class="callout">
                <div class="callout-title">So why does drag matter?</div>
                <p style="margin: 0;">
                    Drag directly affects fuel efficiency and top speed. For instance, a 
                    <a href="https://www.researchgate.net/publication/286228642_Review_of_research_on_vehicles_aerodynamic_drag_reduction_methods" target="_blank">paper conducting research on drag reduction methods</a> 
                    states that reducing drag by 15% can improve highway fuel economy 
                    by up to 5-7% for most vehicles. For race cars on the other hand, less drag means higher straight-line speeds, which is why teams 
                    are so precise and carfeul with bodywork down to the millimeter.
                </p>
            </div>

            <!-- Downforce Section -->
            <h2>Understanding Downforce</h2>

            <p>
                While drag is always present, downforce is something engineers actively design into race cars. Downforce is 
                basically negative lift, the vertical force pushing the car down onto the track. More downforce means 
                better grip, which means faster cornering.
            </p>

            <p>
                The downforce equation is similar to drag:
            </p>

            <div class="equation">
                $$F_{\text{downforce}} = -\frac{1}{2} \rho v^2 C_l A$$
            </div>

            <p>
                where $C_l$ is the lift coefficient, and a negative $C_l$ indicates downforce. 
                Formula 1 cars, for exmaple, can generate 3-4 times their own weight in downforce at high speeds, keeping them attatched to the track 
                at all times (unless there's an inchident).
            </p>

            <h3>The Drag-Downforce Tradeoff</h3>

            <p>
                You may now be wondering: <i>so wouldn't the best body design just incorporate really low drag with higher downforce?</i>
            </p>
            <p>
                That's where the issue of optimization arises. Generating downforce almost always increases drag. Wings, diffusers, and other aerodynamic 
                components that create downforce also create increased turbulence and drag. For this reason, race engineers must balance these forces based on 
                the tracks that they race on. This means prioritizing a high-downforce design for tracks with lots of cornering and chicanes, while using low-drag 
                designs on tracks with more straights.
            </p>

            <!-- Simulation Math -->
            <h2>The Math Behind the Simulation</h2>

            <p>
                To simulate airflow computationally, I used a simplified version of the Navier-Stokes equations, which govern 
                fluid motion. These equations describe how velocity and pressure fields evolve over time in a fluid.
            </p>

            <h3>Navier-Stokes Equations (Simplified 2D)</h3>

            <div class="equation">
                $$\frac{\partial {u}}{\partial t} + {u} \cdot \nabla {u} = -\frac{1}{\rho}\nabla p + \nu \nabla^2 {u}$$
            </div>

            <p>
                This may look slightly intimidating, so let's break it down:
            </p>
            <ul style="margin-left: 40px; margin-bottom: 20px;">
                <li>$\frac{\partial {u}}{\partial t}$ - how velocity changes over time</li>
                <li>$u \cdot \nabla {u}$ - advection (horizontal movement of the fluid)</li>
                <li>$-\frac{1}{\rho}\nabla p$ - pressure gradient (high to low pressure)</li>
                <li>$\nu \nabla^2 {u}$ - viscous diffusion (friction between fluid layers)</li>
            </ul>

            <p>
                In my simulation, I discretized these equations on a grid and solved them iteratively. Each grid cell represents 
                a small volume of air, and we calculate how velocity and pressure change in each cell based on its neighbors.
            </p>

            <h3>Calculating Forces from Pressure</h3>

            <p>
                Once we have the pressure field around the vehicle, we can calculate forces by integrating pressure over the 
                vehicle's surface:
            </p>

            <div class="equation">
                $${F} = \iint p \, \hat{{n}} \, dS$$
            </div>

            <p>
                where $\hat{{n}}$ is the surface normal vector and $dS$ is a surface element. In practice, 
                this means summing up pressure forces on each grid cell that touches the vehicle boundary.
            </p>

            <!-- Visualizations -->
            <h2>Visualizing Different Vehicle Shapes</h2>

            <p>
                Using the simulation, I tested several vehicle shapes to see how they affect airflow, pressure fields, 
                and the resulting forces. The velocity field graphs range from blue (low velocity) to yellow (high velocity), 
                exhibiting the wind speeds at all locations around the vehicle. On the pressure field graphs, the darker red represents areas
                of higher pressure, while the white represents areas of lower pressure. Here's what I was able to visualize:
            </p>

            <div class="visualization-grid">
                <div class="viz-card">
                    <h4>Sedan</h4>
                    <img src="../assets/images/sports_velocity.gif" alt="Sedan airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <img src="../assets/images/sports_pressure.gif" alt="Sedan airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <p class="viz-description">
                        Typical passenger car shape. Moderate drag, minimal downforce. Air flows relatively smoothly over 
                        the rounded front and creates a wake behind the vehicle.
                    </p>
                </div>

                <div class="viz-card">
                    <h4>Sports Car</h4>
                    <img src="../assets/images/sedan_velocity.gif" alt="Sports airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <img src="../assets/images/sedan_pressure.gif" alt="Sedan airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <p class="viz-description">
                        Lower, more aggressive profile. Reduced frontal area lowers drag. Slight downforce from the 
                        sloped rear design directs air upward, pushing the car down.
                    </p>
                </div>

                <div class="viz-card">
                    <h4>SUV</h4>
                    <img src="../assets/images/suv_velocity.gif" alt="SUV airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <img src="../assets/images/suv_pressure.gif" alt="Sedan airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <p class="viz-description">
                        Large frontal area and boxy shape create high drag. Turbulent wake behind the vehicle. 
                        No significant downforce due to practicality over aerodynamics.
                    </p>
                </div>

                <div class="viz-card">
                    <h4>Formula 1 Car</h4>
                    <img src="../assets/images/formula1_velocity.gif" alt="F1 airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <img src="../assets/images/formula1_pressure.gif" alt="Sedan airflow visualization" style="width: 100%; height: 200px; object-fit: cover; border-radius: 4px;">
                    <p class="viz-description">
                        Extreme aerodynamic design with front and rear wings. Massive downforce from inverted airfoils 
                        and ground effect. Higher drag is acceptable for the grip advantage.
                    </p>
                </div>
            </div>

            <div class="callout">
                <div class="callout-title">Key Insight</div>
                <p style="margin: 0;">
                    My reasoning behind this simulation was to show that vehicle shape isn't just about aesthetics,
                    but its actually incredibly important for determining how 
                    air flows around the vehicle body and what forces emerge. Small changes in component angles, curves, and surfaces can 
                    dramatically alter the pressure distribution above and below the car, as well as the resulting forces.
                </p>
            </div>

            <!-- Conclusion -->
            <h2>Wrapping Up</h2>

            <p>
                Simulating aerodynamics computationally gives us a window into the invisible forces that shape and determine vehicle 
                performance. Although I know that this is a simplified 2D simulation, I feel that it still captures the essential physics concepts around vehicle aerodynamics: drag resists 
                motion, downforce improves grip, and geometry is everything.
            </p>

            <p>
                Real-world CFD simulations are <i>much</i> more complex (for starters they're 3D). They include turbulence models, and run on 
                supercomputers for days. But at the end of the day, the fundamental principles remain the same: air flows from high to low 
                pressure, creates forces on surfaces, and follows the laws of fluid dynamics.
            </p>

            <p>
                If you want to explore the code, check out my <a href="https://github.com/hrishid15/vehicle-aero-sim" target="_blank" style="color: #2a2a2a; text-decoration: none; border-bottom: 1px solid #2a2a2a;">GitHub</a>. 
                The full simulation includes multiple vehicle shapes, force calculations, and animated visualizations 
                of the evolving flow fields.
            </p>
        </div>
    </div>

    <!-- Load KaTeX JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <script>
        // Render all math after page loads
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

    <script>
        const canvas = document.getElementById('aeroCanvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Particle system for airflow visualization
        const particles = [];
        const maxParticles = 400;
        let mouseX = -100;
        let mouseY = -100;
        
        class Particle {
            constructor(initial = false) {
                if (initial) {
                    this.initialize();
                } else {
                    this.reset();
                }
            }
            
            reset() {
                this.x = -10 - Math.random() * 50;
                this.y = Math.random() * canvas.height;
                this.speed = 1 + Math.random() * 3;
                this.size = 1 + Math.random() * 2;
                this.opacity = 0.3 + Math.random() * 0.4;
                this.baseY = this.y;
            }
            
            initialize() {
                this.x = Math.random() * (canvas.width + 100) - 50;
                this.y = Math.random() * canvas.height;
                this.speed = 1 + Math.random() * 3;
                this.size = 1 + Math.random() * 2;
                this.opacity = 0.3 + Math.random() * 0.4;
                this.baseY = this.y;
            }
            
            update() {
                this.x += this.speed;
                
                const dx = this.x - mouseX;
                const dy = this.y - mouseY;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist < 120 && dist > 0) {
                    const force = (120 - dist) / 120;
                    this.y += (dy / dist) * force * 3;
                }
                
                this.y += Math.sin(this.x * 0.02 + this.baseY) * 0.3;
                
                if (this.x > canvas.width + 10) {
                    this.reset();
                }
                
                if (this.x > canvas.width - 50) {
                    this.opacity = Math.max(0, this.opacity - 0.02);
                }
            }
            
            draw() {
                ctx.fillStyle = `rgba(139, 115, 85, ${this.opacity})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        for (let i = 0; i < maxParticles; i++) {
            particles.push(new Particle(true));
        }
        
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;
        });
        
        canvas.addEventListener('mouseleave', () => {
            mouseX = -100;
            mouseY = -100;
        });
        
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            ctx.strokeStyle = 'rgba(139, 115, 85, 0.08)';
            ctx.lineWidth = 1;
            for (let i = 0; i < canvas.width; i += 30) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            
            particles.forEach(particle => {
                particle.update();
                particle.draw();
            });
            
            requestAnimationFrame(animate);
        }
        
        animate();
    </script>
</body>
</html>